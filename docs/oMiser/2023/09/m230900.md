<!-- m230900.md 0.2.5               UTF-8                         2026-02-17
     ----1----|----2----|----3----|----4----|----5----|----6----|----7----|--*
     source <https://github.com/orcmid/miser/blob/master/docs/obapx/index.md>
     publication <https://orcmid.github.io/miser/obapx/>
     -->
<table border="0" width="100%">
  <tr>
    <td width="25%" align="left" height="6">
       <a href="../../" title="The Miser Project on GitHub">
       <img src="../../../images/misertheory-logo.png" /></a>
    </td>
       <td width="48%" height="6"><p align="center"><font color="#990033"><strong>
	<i><a href="../../m000001.htm#m230900"><font color="#990033">oMiser Technical Note m230900
    </font></a></i><br />
    <i><big><big>HashFlag Technique</big></big></i></strong></font></p>
    </td>
    <td width="27%" height="6" valign="middle" align="right">
      <b><tt>
      <a href="../../../../" target="_top">orcmid.github.io</a>&gt;
      </tt></b>
      <br />
      <a href="https://clustrmaps.com/site/1bw9w" title="Visit tracker">
            <img src="//www.clustrmaps.com/map_v2.png?d=3-2eQV4fOuelVHp_YtztZ0hl9Uj4ei9zLKw_nRgCgyM&cl=ffffff" />
      </a><br />
      <b>
      <a href="../../../" target="_top">miser</a>&gt;
      <a href="../../" target="_top">oMiser</a>&gt;
      <br /><br /><br />
         <a href="m230900.html" target="_top">m230900</a>&gt;</b>
      <br />
      <small><small>
        0.2.5 2026-02-17T21:02Z<!-- MAINTAIN THIS MANUALLY -->
      </small></small>
      </td>
  </tr>
</table>

In the *provisional* x64 ob-cell storage structure for every Ob, there is a
32-bit (4-byte) word containing a 24-bit (3-byte) Hash value and an
8-bit (1-byte) Flag field. The combination is designated as the HashFlag
field of the ob-cell.

- When two addresses of ob-cells are the same, the represented obs are
necessarily the same.

- When two ob-cells are in different locations *and* their HashFlags are
different, the ob-cell-represented obs are different.

- When two ob-cells are in different locations *but* their HashFlags are the
same, they must be examined further to determine if they are different despite
having the same HashFlags.

There are a number of useful invariants:

- The Flag field is an invariant of the structural properties of an ob. When
HashFlags are the same, the compared ob-cells have identical Flag fields.

- Individuals are never duplicated.  Two references to ob-cells that are
known to be for individuals will be to different individuals if the ob-cell
locations are different, despite any collision of Hash Values.

- Hash values are not based on locations or other characteristics of ob-cells
apart from the structural characteristics of the ob and the determination of
hash values for individuals from known information (such as a lindy's name).

There are also questions to be resolved, requiring both analysis and
experimentation, perhaps by instrumentation of the oMiser implementation.

- What is an usable but simple hashing algorithm for the Hash of an ob pair
from the HashFlags of the components?

- The 24-bit (3-byte) Hash field has to be good enough.  That permits
16,777,215 values (0 being excluded) and collisions are to be expected.

- A 32-bit aligned word is required for the prospective reference count.  The
32-bit word is required because the AddRef and Release actions on any
reference count must be atomic and there are intrinsics for the
32-bit-aligned-word case.

- The derivation of a Hash for every introduction of a new ob-cell adds to the
  computational cost of those actions.  When performed as part of oFrugal
  semantics, this will be negligible.  When performed in the course of an
  application, especially for short-lived ob-cells that will never be exposed
  through the oFrugal API, it must be determined how much this activity
  (along with memory management) can be kept low-cost.  (2026-01-25: It turns
  out that this is not a new problem and a solution was devised so that
  Microsoft Excel could economize on spreadsheet cells having COM interfaces
  only as needed.)

- There is a related consideration with regard to short-lived ob-cells, ones
  that are transient intermediate results in applicative operations. For some
  time I have wanted to leave initial creations of ob-cells on the run-time
  stack, simply dropping them by a retreat of the stack if not swept into a
  longer-lived storage generation.  In that case, perhaps even computation of
  hashes (and actions on reference counts?) might be deferred until a sweep.
    This is all speculative. Henry Baker has done something similar in Chicken
  Scheme (https://www.call-cc.org/) and his clever C Language approach with
  continuations has been described at
  <https://dl.acm.org/doi/10.1145/214448.214454>.


## Folio Catalog

This placeholder links to raw materials and notes, including text files.
There will be organized folios of content as this topic is explored in
detail.

| **ID**                    | **Status**   | **Started** | **Topic** |
|   :-:                     |   :-:        |  :-:        |  ---  |
|                           |              |             |       |
| [m230900a](m230900a.htm)  | undated      | 2025-09-16  | Notes & Work Items |
| [m230900b](m230900b.html) | 0.1.6 2026-02-17 | 2025-09-24  | Hashing Cases |
| [m230900c](m230900c.html) | 0.0.9 2026-02-17 | 2026-02-12 | Ob Comparison |


----

I invite discussion about Miser Project topics in the
[Discussion section](https://github.com/orcmid/miser/discussions).
Improvements and removal of defects in this particular documentation can be
reported and addressed in the
[Issues section](https://github.com/orcmid/miser/issues).  There are also
relevant [projects](https://github.com/orcmid/miser/projects?type=classic)
from time to time.

<table border="0" cellspacing="3" width="100%">
  <tr>
    <td width="14%">
	<a href="index.htm" target="_top">
       <img border="0" src="../../../images/hardhat-thumb.gif" alt="Hard Hat Area"
            align="left" width="80" height="57">
       </a>
    </td>
    <td width="54%" valign="middle" align="center">
      You are navigating the <a href="../../../">Miser Project on Github</a></td>
    <td width="30%">
      <p align="right"><font size="-2">created 2025-09-14 by
         <a target="_top" href="../../../../orcmid">orcmid</a> </font></p>
    </td>
  </tr>
</table>
<!--

  0.2.5  2026-02-17T21:02Z 0.0.9 m230900c
  0.2.4  2026-02-17T01:43Z Touch-up plus m2030900b and m2030900c
  0.2.3  2026-02-14T02:45Z 0.0.2 m230900c
  0.2.2  2026-02-12T21:43Z 0.0.0 m230900c
  0.2.1  2026-01-25T23:15Z 0.1.4 m230900b
  0.2.0  2026-01-25T21:55Z Reflect having to allow for 32-bit reference count
  0.1.8  2026-01-25T20:04Z Reflect new insights on reference counting and
         hashing
  0.1.7  2025-11-07T02:11Z Clean up the account of on-stack ob-cell creation
  0.1.6  2025-11-06T18:41Z Touch-ups, hat tip to Henry Baker
  0.1.5  2025-09-26T05:03Z 0.1.0 m230900b
  0.1.4  2025-09-25T18:46Z Add performance consideration
  0.1.3  2025-09-24T23:24Z Introduce m230900b
  0.1.2  2025-09-19T15:58Z Word-smithing and more context block repair
  0.1.1  2025-09-19T04:45Z Experiment with <tt> tags (failed)
  0.1.0  2025-09-19T01:09Z Clean up context block, title touch-up
  0.0.4  2025-09-18T21:45Z Touch-ups and more link repairs
  0.0.3  2025-09-18T19:48Z Correct the title block text and links
  0.0.2  2025-09-18T00:52Z Complete the overview
  0.0.1  2025-09-16T22:04Z Identify and provide initial draft skeleton
  0.0.0  2025-09-14T21:44Z Initial placeholder from hybridForm boilerplate


               *** end of oMiser/2023/09/m230900.md/ ***                  -->
