<!-- m230900.md 0.1.6               UTF-8                         2025-11-06
     ----1----|----2----|----3----|----4----|----5----|----6----|----7----|--*
     source <https://github.com/orcmid/miser/blob/master/docs/obapx/index.md>
     publication <https://orcmid.github.io/miser/obapx/>
     -->
<table border="0" width="100%">
  <tr>
    <td width="25%" align="left" height="6">
       <a href="../../" title="The Miser Project on GitHub">
       <img src="../../../images/misertheory-logo.png" /></a>
    </td>
       <td width="48%" height="6"><p align="center"><font color="#990033"><strong>
	<i><a href="../../m000001.htm#m230900"><font color="#990033">oMiser Technical Note m230900
    </font></a></i><br />
    <i><big><big>HashFlags Technique</big></big></i></strong></font></p>
    </td>
    <td width="27%" height="6" valign="middle" align="right">
      <b><tt>
      <a href="../../../../" target="_top">orcmid.github.io</a>&gt;
      </tt></b>
      <br />
      <a href="https://clustrmaps.com/site/1bw9w" title="Visit tracker">
            <img src="//www.clustrmaps.com/map_v2.png?d=3-2eQV4fOuelVHp_YtztZ0hl9Uj4ei9zLKw_nRgCgyM&cl=ffffff" />
      </a><br />
      <b>
      <a href="../../../" target="_top">miser</a>&gt;
      <a href="../../" target="_top">oMiser</a>&gt;
      <br /><br /><br />
         <a href="m230900.html" target="_top">m230900</a>&gt;</b>
      <br />
      <small><small>
        0.1.6 2025-11-06T18:41Z<!-- MAINTAIN THIS MANUALLY -->
      </small></small>
      </td>
  </tr>
</table>

In the *tentative* x64 ob-cell storage structure for every Ob, there is a
64-bit (8-byte) word containing at most a 56-bit (7-byte) Hash value and an
8-bit (1-byte) Flag field. The combination is designated as the HashFlags
field of the ob-cell.

- When two addresses of ob-cells are the same, the represented obs are
necessarily the same.

- When two ob-cells are in different locations *and* their HashFlags are
different, the ob-cell-represented obs are different.

- When two ob-cells are in different locations *but* their HashFlags are the
same, they must be examined further to determine if they are different despite
having the same HashFlags.

There are a number of useful invariants:

- The Flag field is an invariant of the structural properties of an ob. When
HashFlags are the same, the compared ob-cells have identical Flag fields.

- Individuals are never duplicated.  Two references to ob-cells that are
known to be for individuals will be to different individuals if the ob-cell
locations are different, despite any collision of Hash Values.

- Hash values are not based on locations or other characteristics of ob-cells
apart from the structural characteristics of the ob and the determination of
hash values for individuals from known information (such as a lindy's name).

There are also questions to be resolved, requiring both analysis and
experimentation, perhaps by instrumentation of the oMiser implementation.

- What is an usable but simple hashing algorithm for the Hash of an ob pair
from the HashFlags of the components?

- Is a 24-bit (3-byte) or 32-bit (4-byte) Hash field good enough?  Having at
least 24 bits unassigned provides space for reference counting as an
alternative to garbage collection.

- Is a 24-bit (3-byte) field adequate for an optional reference count? (A
collateral question as part of keeping x64 ob-cells to 4 64-bit words)

- When recursive descent is required to confirm or refute the matching of
HashFlags, the process repeats so long as HashFlag matching continues. At
each level where matching of different ob-cells is confirmed, there may be
opportunity to replace the reference to one with a reference to the other.
The advantage is potential release of some ob-cells and improvement of future
comparisons by having more locations match. The question is whether this is
worth the additional processing on those occasions, and whether even checking
for it is worthwhile in what we want to be a very rapid process.

- The derivation of a Hash for every introduction of a new ob-cell adds to the
  computational cost of those actions.  When performed as part of oFrugal
  semantics, this will be negligible.  When performed in the course of an
  application, especially for short-lived ob-cells that will never be exposed
  through the oFrugal API, it must be determined how much this activity
  (along with memory management) can be kept low-cost.

- There is a related consideration with regard to short-lived ob-cells, ones
  that are transient intermediate results in applicative operations. At one
  time, leaving initial creations of ob-cells on the run-time stack until
  simply dropping them by a retreat of the stack, unless swept into a longer-living storage generation, was entertained.  In that case, perhaps
  even computation of hashes (and action on reference counts?) might be
  deferred until a sweep.
    This is all speculative. I've learned that Henry Baker may have done
  something similar in Chicken Scheme (https://www.call-cc.org/) and I should
  see if that is workable for oMiser.  We talked about this notion back at the
  first AAAI conference when I was thinking of CP/M and Z-80 implementations
  where hardware stacks were usable. This becomes rather platform-specific,
  but could be worth it, performance wise. The trick is to avoid dragging
  around so many intermediate ob-cells that the run-time stack overflows.
  There is also a small matter that Just-In-Time (JIT) generation of machine
  code might make much intermediate ob-cell creation go away, making this
  technique a lost cause.

## Folio Catalog

This placeholder links to raw materials and notes, including text files.
There will be organized folios of content as this topic is explored in
detail.

| **ID**                    | **Status**   | **Started** | **Topic** |
|   :-:                     |   :-:        |  :-:        |  ---  |
|                           |              |             |       |
| [m230900a](m230900a.htm)  | undated      | 2025-09-16  | Notes & Work Items |
| [m230900b](m230900b.html) | 0.1.0 2025-09-26 | 2025-09-24  | Hashing Cases |


----

I invite discussion about Miser Project topics in the
[Discussion section](https://github.com/orcmid/miser/discussions).
Improvements and removal of defects in this particular documentation can be
reported and addressed in the
[Issues section](https://github.com/orcmid/miser/issues).  There are also
relevant [projects](https://github.com/orcmid/miser/projects?type=classic)
from time to time.

<table border="0" cellspacing="3" width="100%">
  <tr>
    <td width="14%">
	<a href="index.htm" target="_top">
       <img border="0" src="../../../images/hardhat-thumb.gif" alt="Hard Hat Area"
            align="left" width="80" height="57">
       </a>
    </td>
    <td width="54%" valign="middle" align="center">
      You are navigating the <a href="../../../">Miser Project on Github</a></td>
    <td width="30%">
      <p align="right"><font size="-2">created 2025-09-14 by
         <a target="_top" href="../../../../orcmid">orcmid</a> </font></p>
    </td>
  </tr>
</table>
<!--

  0.1.6  2025-11-06T18:41Z Touch-ups, hat tip to Henry Baker
  0.1.5  2025-09-26T05:03Z 0.1.0 m230900b
  0.1.4  2025-09-25T18:46Z Add performance consideration
  0.1.3  2025-09-24T23:24Z Introduce m230900b
  0.1.2  2025-09-19T15:58Z Word-smithing and more context block repair
  0.1.1  2025-09-19T04:45Z Experiment with <tt> tags (failed)
  0.1.0  2025-09-19T01:09Z Clean up context block, title touch-up
  0.0.4  2025-09-18T21:45Z Touch-ups and more link repairs
  0.0.3  2025-09-18T19:48Z Correct the title block text and links
  0.0.2  2025-09-18T00:52Z Complete the overview
  0.0.1  2025-09-16T22:04Z Identify and provide initial draft skeleton
  0.0.0  2025-09-14T21:44Z Initial placeholder from hybridForm boilerplate


               *** end of oMiser/2023/09/m230900.md/ ***                  -->
