<!-- m110400c.md 0.0.1              UTF-8                         2026-02-26
     ----1----|----2----|----3----|----4----|----5----|----6----|----7----|--*
     source <https://github.com/orcmid/miser/blob/master/docs/omiser/2023/09/m230900c.md>
     publication <https://orcmid.github.io/miser/omiser/2011/04/m110400c.html>
     -->
<table border="0" width="100%">
  <tr>
    <td width="25%" align="left" height="6">
       <a href="../../" title="The Miser Project on GitHub">
       <img src="../../../images/misertheory-logo.png" /></a>
    </td>
    <td width="48%" height="6" valign="middle" align="center">
       <font color="#990033"><strong>
	      <i><a href="m110400.html#5-related-material">
          <font color="#990033">oMiser Technical Note m110400
          </font></a></i><br />
          <i><big><big><a href="m110400b.html">MOb API</a>
             </big></big></i>
        </strong></font>
    </td>
    <td width="27%" height="6" valign="middle" align="right">
      <b><tt>
      <a href="../../../../" target="_top">orcmid.github.io</a>&gt;
      </tt></b>
      <br />
      <a href="https://clustrmaps.com/site/1bw9w" title="Visit tracker">
            <img src="//www.clustrmaps.com/map_v2.png?d=3-2eQV4fOuelVHp_YtztZ0hl9Uj4ei9zLKw_nRgCgyM&cl=ffffff" />
      </a><br />
      <b>
      <a href="../../../" target="_top">miser</a>&gt;
      <a href="../../" target="_top">oMiser</a>&gt;
      <br /><br /><br />
         <a href="m110400c.html" target="_top">m110400c</a>&gt;</b>
      <br />
      <small><small>
        0.0.1 2026-02-26T17:58Z<!-- MAINTAIN THIS MANUALLY -->
      </small></small>
      </td>
  </tr>
</table>

## 1. Establishing oMiser and the MOb

The initialization of an oMiser instance involves establishment of the
initial MOb.  This is accomplished with the `omEstablish` procedure,

```c
HRESULT omEstablish( const CLSID* omClassID, const IID* riid,
                     void **ppvObject );
```

defined in the oMiser header files "oMiser-Win32.h" and "oMiser-Win32.hpp" for
C and C++, respectively.  This is the oMiser-specialized counterpart of a COM
class factory.

The supported `omClassID` values are defined in the header files for the
current oMiser version.  The practice is to support earlier `omClassID`s until
breaking changes make that infeasible.  Preserving earlier `omClassID`s also
preserves tests that are developed with the earlier versions of the oMiser COM
classes.

The `riid` parameter must be either for `IUnknown` or `IMOb`.

## 2. Simplified Interfaces

An established MOb permits simplified interface helpers because there is
always one and only one established MOb.  This allows helper operations with
simplified parameters.  For example,

```c
HRESULT omGetLindy(const char[] id, void **ppvIOb);
```

Is a friendlier version of

```c
HRESULT ppvIMOb->pv->GetLindy(ppvIMOb, const char[] id, void **ppvIob);
```

where, in the friendly case, the ppvIMOb is held privately to the set of
friendly versions.  The friendly versions are the same for both C and C++.
The results are still COM Interface pointers, but for Iob interfaces.

There is an additional HRESULT defined for the case that there has been no
successful `omEstablish` before a friendly operation is attempted.

## 3. Strings vs. BSTR

Officially, strings of characters must be in `BSTR` (Unicode UTF16-LE) form
for correct use in COM interfaces.  The difficulty of `BSTR` for oMiser is
with the high incidence of wide (16-bit) character codes with many `0` bits.
This does not work well for hashing of identifiers.

UTF8 strings are used in the oMiser API to facilitate hashing and also
economize on storage in US and Western European settings.  The trade-off
will be reviewed after there is more experience and good statistics between
UTF8 and UTF16-LE (BSTR) coding of identifiers used with oMiser and oFrugal.

In the determination of identifier length, each code point, regardless of
its length in UTF-8, counts as one character.  Whether the Standard C Language
allowance for identifiers of up to 63 ***characters*** is tolerated, the
practice of truncating longer identifiers, if implemented, will lead to
oMiser warnings.

## 4. The Friendly API

----

I invite discussion about Miser Project topics in the
[Discussion section](https://github.com/orcmid/miser/discussions).
Improvements and removal of defects in this particular documentation can be
reported and addressed in the
[Issues section](https://github.com/orcmid/miser/issues).  There are also
relevant [projects](https://github.com/orcmid/miser/projects?type=classic)
from time to time.

<table border="0" cellspacing="3" width="100%">
  <tr>
    <td width="14%">
	<a href="index.htm" target="_top">
       <img border="0" src="../../../images/hardhat-thumb.gif" alt="Hard Hat Area"
            align="left" width="80" height="57">
       </a>
    </td>
    <td width="54%" valign="middle" align="center">
      You are navigating the <a href="../../../">Miser Project on Github</a></td>
    <td width="30%">
      <p align="right"><font size="-2">created 2026-02-25 by
         <a target="_top" href="../../../../orcmid">orcmid</a> </font></p>
    </td>
  </tr>
</table>
<!--


  0.0.1  2026-02-26T17:58Z Intermediate Draft
  0.0.0  2026-02-25T22:11Z Placehoder note

               *** end of oMiser/2011/04/m110400c.md ***                  -->
